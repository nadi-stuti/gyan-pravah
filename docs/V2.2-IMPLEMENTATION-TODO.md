# Version 2.2 Implementation TODO

## ‚úÖ Completed

1. **Wrong Answer Handling**
   - ‚úÖ Removed popup for wrong answers
   - ‚úÖ Show correct answer highlighted on card
   - ‚úÖ Show wrong answer in red
   - ‚úÖ 2.5 second display time

2. **Topic Display Fix**
   - ‚úÖ Fixed to show subtopic name
   - ‚úÖ Proper fallback chain

## ‚è≥ TODO - High Priority

### 1. Reaction Time Tracking

**File:** `app/stores/useQuizStore.ts`

Add to state:
```typescript
interface QuizState {
  reactionTimes: number[] // Time taken per question in seconds
  averageReactionTime: number // Running average
  
  // Add action
  recordReactionTime: (time: number) => void
  calculateAverageReactionTime: () => number
}
```

Implementation:
```typescript
recordReactionTime: (time) => {
  set((state) => {
    const newTimes = [...state.reactionTimes, time]
    const average = newTimes.reduce((a, b) => a + b, 0) / newTimes.length
    return {
      reactionTimes: newTimes,
      averageReactionTime: average
    }
  })
}
```

**File:** `app/components/quiz/QuizGameLogic.tsx`

Update handleAnswer:
```typescript
const handleAnswer = useCallback((answer: 'A' | 'B' | 'C' | 'D') => {
  // ... existing code
  const timeTaken = config.questionTimeLimit - timeRemaining
  
  // Record reaction time
  recordReactionTime(timeTaken)
  
  // ... rest of code
}, [/* deps */])
```

### 2. Temperature Meter in GameHeader

**File:** `app/components/quiz/GameHeader.tsx`

Add reaction time display:
```typescript
interface GameHeaderProps {
  currentQuestion: number
  totalQuestions: number
  score: number
  averageReactionTime?: number // Add this
}

// Temperature meter component
function ReactionTimeMeter({ avgTime }: { avgTime: number }) {
  const getTemperature = () => {
    if (avgTime < 3) return { emoji: 'üî•', color: 'bg-red-500', label: 'Hot' }
    if (avgTime < 5) return { emoji: 'üå°Ô∏è', color: 'bg-yellow-400', label: 'Warm' }
    if (avgTime < 7) return { emoji: '‚ùÑÔ∏è', color: 'bg-blue-400', label: 'Cool' }
    return { emoji: 'üßä', color: 'bg-blue-600', label: 'Cold' }
  }
  
  const temp = getTemperature()
  
  return (
    <div className="flex items-center gap-2">
      <span className="text-2xl">{temp.emoji}</span>
      <div className="flex flex-col">
        <span className="text-xs text-gray-600">Avg Speed</span>
        <div className={`${temp.color} text-white px-2 py-1 rounded-full text-xs font-semibold`}>
          {avgTime.toFixed(1)}s {temp.label}
        </div>
      </div>
    </div>
  )
}
```

### 3. Results Screen Redesign

**File:** `app/app/results/page.tsx`

#### 3.1 Quiz Summary Pill (Single Line)

```typescript
function QuizSummaryPill({ questions, selectedAnswers, pointsPerQuestion, reactionTimes }) {
  const getQuestionStatus = (index: number) => {
    const answer = selectedAnswers[index]
    const points = pointsPerQuestion[index] || 0
    const time = reactionTimes[index] || 0
    
    if (!answer) return { color: 'bg-gray-600', label: 'Skipped' }
    if (answer !== questions[index].correctOption) return { color: 'bg-red-400', label: 'Wrong' }
    
    // Correct answer - check speed
    if (time >= 8) return { color: 'bg-yellow-400', label: 'Super Fast' }
    if (time >= 3) return { color: 'bg-green-400', label: 'Fast' }
    return { color: 'bg-gray-400', label: 'Late' }
  }
  
  return (
    <div className="flex gap-1 overflow-x-auto py-2">
      {questions.map((_, index) => {
        const status = getQuestionStatus(index)
        return (
          <div
            key={index}
            className={`${status.color} text-white px-3 py-2 rounded-full text-xs font-semibold whitespace-nowrap`}
            title={`Q${index + 1}: ${status.label}`}
          >
            {index + 1}
          </div>
        )
      })}
    </div>
  )
}
```

#### 3.2 Paginated Review Cards

```typescript
function PaginatedReviewCards({ questions, selectedAnswers, pointsPerQuestion, reactionTimes }) {
  const [currentIndex, setCurrentIndex] = useState(0)
  
  const currentQuestion = questions[currentIndex]
  const userAnswer = selectedAnswers[currentIndex]
  const points = pointsPerQuestion[currentIndex] || 0
  const reactionTime = reactionTimes[currentIndex] || 0
  
  return (
    <div className="space-y-4">
      {/* Question Counter */}
      <div className="text-center text-sm text-gray-600">
        Question {currentIndex + 1} of {questions.length}
      </div>
      
      {/* Review Card */}
      <ReviewCard
        question={currentQuestion}
        userAnswer={userAnswer}
        points={points}
        reactionTime={reactionTime}
        questionNumber={currentIndex + 1}
      />
      
      {/* Navigation Buttons */}
      <div className="flex justify-between">
        <button
          onClick={() => setCurrentIndex(prev => Math.max(0, prev - 1))}
          disabled={currentIndex === 0}
          className="px-4 py-2 bg-gray-300 rounded-lg disabled:opacity-50"
        >
          ‚Üê Previous
        </button>
        <button
          onClick={() => setCurrentIndex(prev => Math.min(questions.length - 1, prev + 1))}
          disabled={currentIndex === questions.length - 1}
          className="px-4 py-2 bg-[#8B7FC8] text-white rounded-lg disabled:opacity-50"
        >
          Next ‚Üí
        </button>
      </div>
    </div>
  )
}
```

#### 3.3 Detailed Scoring Math in Review Card

```typescript
function ScoringBreakdown({ points, reactionTime, isBonus }) {
  const timeRemaining = 10 - reactionTime
  const isSuperFast = timeRemaining >= 8
  const isFast = timeRemaining >= 3 && timeRemaining < 8
  const isLate = timeRemaining < 3
  
  return (
    <div className="bg-gray-50 rounded-xl p-4 space-y-2">
      <h4 className="font-semibold text-gray-900">Scoring Breakdown</h4>
      
      <div className="space-y-1 text-sm">
        <div className="flex justify-between">
          <span>Time Remaining:</span>
          <span className="font-semibold">{timeRemaining.toFixed(1)}s</span>
        </div>
        
        <div className="flex justify-between">
          <span>Category:</span>
          <span className="font-semibold">
            {isSuperFast ? 'Super Fast ‚ö°' : isFast ? 'Fast üí®' : 'Late üêå'}
          </span>
        </div>
        
        <div className="border-t pt-2 mt-2">
          {isSuperFast && (
            <>
              <div className="flex justify-between">
                <span>Base Points:</span>
                <span>+10</span>
              </div>
              <div className="flex justify-between">
                <span>Fast Bonus:</span>
                <span>+5</span>
              </div>
              <div className="flex justify-between">
                <span>Super Fast Bonus:</span>
                <span>+5</span>
              </div>
            </>
          )}
          
          {isFast && (
            <>
              <div className="flex justify-between">
                <span>Base Points:</span>
                <span>+10</span>
              </div>
              <div className="flex justify-between">
                <span>Speed Bonus:</span>
                <span>+{Math.floor(timeRemaining - 3)}</span>
              </div>
            </>
          )}
          
          {isLate && (
            <div className="flex justify-between">
              <span>Late Answer:</span>
              <span>+5</span>
            </div>
          )}
          
          {isBonus && (
            <div className="flex justify-between text-purple-600 font-semibold">
              <span>Bonus Round Multiplier:</span>
              <span>√ó2</span>
            </div>
          )}
        </div>
        
        <div className="border-t pt-2 mt-2 flex justify-between font-bold text-lg">
          <span>Total Points:</span>
          <span className="text-[#8B7FC8]">+{points}</span>
        </div>
      </div>
    </div>
  )
}
```

#### 3.4 Updated Action Buttons

```typescript
function ResultsActions({ 
  onPlayAgain, 
  onToggleMode, 
  onChooseTopic, 
  onGoHome,
  isExpertMode 
}) {
  return (
    <div className="space-y-3">
      <button
        onClick={onPlayAgain}
        className="w-full bg-[#8B7FC8] text-white py-3 rounded-xl font-semibold"
      >
        üîÑ Play Again
      </button>
      
      <button
        onClick={onToggleMode}
        className="w-full bg-green-500 text-white py-3 rounded-xl font-semibold"
      >
        {isExpertMode ? 'üìö Try Normal Mode' : '‚ö° Try Expert Mode'}
      </button>
      
      <button
        onClick={onChooseTopic}
        className="w-full bg-blue-500 text-white py-3 rounded-xl font-semibold"
      >
        üìñ Choose Topic
      </button>
      
      <button
        onClick={onGoHome}
        className="w-full bg-gray-500 text-white py-3 rounded-xl font-semibold"
      >
        üè† Go to Home
      </button>
    </div>
  )
}
```

### 4. Average Reaction Time Display in Results

**File:** `app/app/results/page.tsx`

Add above percentage display:
```typescript
<div className="text-center mb-6">
  <div className="text-sm text-gray-600 mb-2">Average Reaction Time</div>
  <div className="text-4xl font-bold text-[#8B7FC8] mb-1">
    {averageReactionTime.toFixed(1)}s
  </div>
  <ReactionTimeMeter avgTime={averageReactionTime} />
</div>

<div className="text-center">
  <div className="text-sm text-gray-600 mb-2">Accuracy</div>
  <div className="text-4xl font-bold text-[#8B7FC8]">
    {percentage}%
  </div>
</div>
```

## üìã Testing Checklist

- [ ] Wrong answers show correct answer highlighted
- [ ] Wrong answers show user answer in red
- [ ] Topic pill shows correct subtopic name
- [ ] Reaction time tracked for each question
- [ ] Average reaction time calculated correctly
- [ ] Temperature meter displays in GameHeader
- [ ] Temperature meter updates in real-time
- [ ] Quiz summary pill shows all questions in one line
- [ ] Color codes match question performance
- [ ] Review cards paginate correctly
- [ ] Next/Previous buttons work
- [ ] Scoring math breakdown is accurate
- [ ] Play Again maintains preferences
- [ ] Mode toggle works correctly
- [ ] Choose Topic navigates correctly
- [ ] Go Home button works
- [ ] Average reaction time shows in results
- [ ] All animations are smooth
- [ ] Mobile responsive

## üéØ Priority Order

1. **High Priority** (Core functionality)
   - Reaction time tracking in store
   - Temperature meter in GameHeader
   - Quiz summary pill

2. **Medium Priority** (UX improvements)
   - Paginated review cards
   - Detailed scoring math
   - Average reaction time in results

3. **Low Priority** (Polish)
   - Updated action buttons
   - Animations and transitions
   - Mobile optimization

---

**Document Created:** November 14, 2025  
**Status:** üîÑ In Progress  
**Estimated Completion:** TBD
